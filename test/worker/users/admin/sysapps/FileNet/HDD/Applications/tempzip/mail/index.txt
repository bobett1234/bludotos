thisis[actT.x].callback = function(a) {
Doc.ajax('html.txt', function(obj) {
    window.tester = obj;
    Doc.ajax('getmesg.php', function(obj) {
    window.tested = obj; 
    window.tester.children[2].innerHTML += window.tested.innerHTML;
    Doc.innerHTML += tester.innerHTML; 
}, 'html', 'server={'+a[0]+':143/novalidate-cert}INBOX&username='+a[1]+'&password='+a[2], false);
}, 'html', null, false);
window.tester.children[2].innerHTML = window.tested.innerHTML;
Doc.innerHTML = tester.innerHTML;
Doc.parentNode.onclose = function() {
    var closeapp = new XMLHttpRequest();
        var sendit2 = 'name='+window.tempname;
        closeapp.open('POST', 'users/<? echo $user; ?>/sysapps/FileNet/resolve.php', true);
	closeapp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
	//goto2.setRequestHeader("Content-length", sendit2.length);
	closeapp.onreadystatechange = function() {
	if (closeapp.readyState==4) {
window.dock.removeApp(window.tempname);
}
}
setInterval(function(){thisis[actT.x].callback(a)}, 1000);
closeapp.send(sendit2);
    delete window.tested;
    delete window.tester;
    delete Doc;
    thisis.pop();
    return true;
};
};
Doc.ajax('prefs.php', function(obj) {
    window.tested2 = obj;
    if(window.tested2.accounts.length < 1) {
        MainTools.popup(['test', 'test2', 'test3']);
    } else {
        window.a = [];
        a[0] = window.tested2.accounts[0].server;
        a[1] = window.tested2.accounts[0].username;
        a[2] = window.tested2.accounts[0].password;
        thisis[actT.x].callback(a);
    };
}, 'json', null, false);